(()=>{"use strict";var e={};e.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),(()=>{var t;e.g.importScripts&&(t=e.g.location+"");var a=e.g.document;if(!t&&a&&(a.currentScript&&(t=a.currentScript.src),!t)){var r=a.getElementsByTagName("script");r.length&&(t=r[r.length-1].src)}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),e.p=t})();const t=e.p+"b5a3330e50459dd80658.mp3",a=e.p+"25ff6f54a1f7a59bf296.mp3",r=e.p+"e980c078329d82398e99.mp3",n=new Audio(t),o=new Audio(a),l=new Audio(r);async function s(e){await new Promise((e=>{n.play(),n.onended=e})),!0===e?(console.log("hadsfasd"),o.play()):l.play()}n.load(),o.load(),l.load();const i=(e,t=null,a=null,r=null,n="x")=>{let o=0,l=e;return{length:l,name:t,x:a,y:r,axis:n,get hitNumber(){return o},set setHits(e){o=e},hit:()=>(o+=1,o),isSunk:()=>o>=l}},d=(e=null)=>{const t=e,a=(()=>{const e=[i(5,"Carrier"),i(4,"Battleship"),i(3,"Cruiser"),i(3,"Submarine"),i(2,"Destroyer")],t=[],a=[];return{boardLength:10,fleet:e,occupiedSquares:t,placeShip:(a,r,n,o)=>{let l=e.filter((e=>e.name===a))[0];if(r<0||r>9||n<0||n>9)throw new Error("Location out of bounds");if("x"===o&&r>10-l.length||"y"===o&&n>10-l.length)throw new Error("Ship partially out of bounds");if("x"===o)for(let e=0;e<l.length;e++)if(t.filter((t=>t.x===r+e&&t.y===n)).length>0)throw new Error("Another ship is in the way");if("y"===o)for(let e=0;e<l.length;e++)if(t.filter((t=>t.x===r&&t.y===n+e)).length>0)throw new Error("Another ship is in the way");if(l.x=parseInt(r),l.y=parseInt(n),l.axis=o,t.filter((e=>e.name===l.name)).length>0){let e=t.filter((e=>e.name===l.name))[0];for(let t=0;t<l.length;t++)"x"===o?(e.x=l.x+1,e.y=l.y):(e.x=l.x,e.y=l.y+1);return l}for(let e=0;e<l.length;e++)"x"===o?t.push({x:l.x+e,y:l.y,name:l.name}):t.push({x:l.x,y:l.y+e,name:l.name});return l},shotRecord:a,receiveAttack:(t,r)=>{t=parseInt(t),r=parseInt(r),a.push({x:t,y:r});let n=!1;for(const a of e)if("x"===a.axis){if(t>=a.x&&t<a.x+a.length&&r===a.y)return a.hit(),n=!0,s(!0),n}else if("y"===a.axis&&t===a.x&&r>=a.y&&r<a.y+a.length)return a.hit(),n=!0,s(!0),n;return s(!1),n},allSunk:()=>e.every((e=>e.isSunk()))}})();return{name:t,gameboard:a,attack:(e,t,a)=>{let r=parseInt(t),n=parseInt(a);if(r<0||r>=e.gameboard.boardLength||n<0||n>=e.gameboard.boardLength)throw new Error("Attack out of bounds");if(0!=e.gameboard.shotRecord.filter((e=>e.x===r&&e.y===n)).length)throw new Error("Attack redundant");return{success:e.gameboard.receiveAttack(r,n),x:r,y:n}},randomlyPlaceShips:()=>{a.fleet.forEach(((e,t,r)=>{let n=Math.random(),o=null,l=null,s=null;for(n>.5?(s="x",o=Math.floor(Math.random()*(a.boardLength-e.length)),l=Math.floor(Math.random()*a.boardLength)):(s="y",o=Math.floor(Math.random()*a.boardLength),l=Math.floor(Math.random()*(a.boardLength-e.length)));u(e,s,o,l,a.occupiedSquares);)n=Math.random(),n>.5?(s="x",o=Math.floor(Math.random()*(a.boardLength-e.length)),l=Math.floor(Math.random()*a.boardLength)):(s="y",o=Math.floor(Math.random()*a.boardLength),l=Math.floor(Math.random()*(a.boardLength-e.length)));a.placeShip(e.name,o,l,s)}))}}};let c=d("You"),h=d("Computer");function u(e,t,a,r,n){let o=[];if("x"===t)for(let t=0;t<e.length;t++)o.push({x:parseInt(a)+t,y:parseInt(r)});else if("y"===t)for(let t=0;t<e.length;t++)o.push({x:parseInt(a),y:parseInt(r)+t});for(let t=0;t<o.length;t++)if(n.filter((a=>a.x==o[t].x&&a.y==o[t].y&&null!==a.x&&null!==a.y&&a.name!==e.name)).length>0)return!0;return!1}h.randomAttack=function(e){let t=Math.floor(Math.random()*e.gameboard.boardLength),a=Math.floor(Math.random()*e.gameboard.boardLength);for(;0!=e.gameboard.shotRecord.filter((e=>e.x===t&&e.y===a)).length;)t=Math.floor(Math.random()*e.gameboard.boardLength),a=Math.floor(Math.random()*e.gameboard.boardLength);return h.attack(e,t,a)},h.randomlyPlaceShips();const m=document.getElementById("playerGB"),g=document.getElementById("cpuGB"),f=document.getElementById("cpuGBcontainer"),y=document.getElementById("hit-or-miss"),p=document.getElementById("announcements"),x=document.querySelector("[data-end-game-message]"),b=document.getElementById("end-game-message"),L=(document.getElementById("fleet"),(e,t=null)=>{for(let a=0;a<100;a++){let r=document.createElement("div"),n=a;r.setAttribute("data-x",n%10),r.setAttribute("data-y",Math.floor(n/10)),a<10&&(n="0"+String(n)),r.classList.add("cell"),r.id=e.id+n,t&&r.addEventListener("click",t),e.append(r)}}),S=(e,t,a)=>{[...e.querySelectorAll(`#${e.id}> .cell`)].forEach((e=>{e.addEventListener(a,t)}))},k=(e,t,a)=>{[...e.querySelectorAll(`#${e.id}> .cell`)].forEach((e=>{e.removeEventListener(a,t)}))},w=(e,t,a,r)=>{let n=null;"computer"===e&&(n="playerGB"),"human"===e&&(n="cpuGB");let o=document.getElementById(`${n}`).querySelector(`[data-x="${t}"][data-y="${a}"]`);r?o.classList.add("hit"):o.classList.add("miss")};let E=!1;const v=document.getElementById("changeShip");let $=0,A=c.gameboard.fleet[$];const M=e=>{((e,t)=>{let a=e.target.getAttribute("data-x"),r=e.target.getAttribute("data-y");if(E){if(a!=t.x||r!=t.y)return;E=!1,v.disabled=!0;for(let e=0;e<t.length;e++)c.gameboard.occupiedSquares.pop();[...document.querySelectorAll(".cell")].forEach((e=>{e.dataset.ship===`${t.name}`&&e.classList.remove("set")}))}else if(!("x"===t.axis&&a>10-t.length||"y"===t.axis&&r>10-t.length)){if(u(t,t.axis,a,r,c.gameboard.occupiedSquares))return console.log(c.gameboard.occupiedSquares),void console.log("blocked");E=!0,c.gameboard.placeShip(t.name,a,r,t.axis);for(let e=0;e<t.length;e++){let a=null;if("x"===t.axis){let r=parseInt(t.x)+e;a=document.querySelector(`[data-x="${r}"][data-y="${t.y}"]`)}if("y"===t.axis){let r=parseInt(t.y)+e;a=document.querySelector(`[data-x="${t.x}"][data-y="${r}"]`)}0===e&&a.classList.add("head"),a.classList.add("hasShip"),a.classList.add("set"),a.dataset.ship=`${t.name}`}E=!0,v.disabled=!1}})(e,A)},C=e=>{((e,t)=>{if(e.target.getAttribute("data-x")==t.x&&e.target.getAttribute("data-y")==t.y&&!0===E){E=!1,v.disabled=!0;for(let e=0;e<t.length;e++)c.gameboard.occupiedSquares.pop()}[...document.querySelectorAll(".cell")].forEach((e=>{e.dataset.ship===`${t.name}`&&(e.classList.remove("set"),e.classList.remove("hasShip"))})),"x"===t.axis&&t.y<=10-t.length?t.axis="y":"y"===t.axis&&t.x<=10-t.length&&(t.axis="x");for(let e=0;e<t.length;e++){if("x"===t.axis){let a=parseInt(t.x)+e,r=document.querySelector(`[data-x="${a}"][data-y="${t.y}"]`);0===e&&r.classList.add("head"),r.classList.add("hasShip"),r.dataset.ship=`${t.name}`}if("y"===t.axis){let a=parseInt(t.y)+e,r=document.querySelector(`[data-x="${t.x}"][data-y="${a}"]`);0===e&&r.classList.add("head"),r.classList.add("hasShip"),r.dataset.ship=`${t.name}`}}})(e,A)},I=e=>{((e,t)=>{if(E)return;let a=e.target.getAttribute("data-x"),r=e.target.getAttribute("data-y");if(!("x"===t.axis&&a>10-t.length||"y"===t.axis&&r>10-t.length||u(t,t.axis,a,r,c.gameboard.occupiedSquares))){[...document.querySelectorAll(`[data-ship=${t.name}]`)].forEach((e=>{e.dataset.ship===`${t.name}`&&(delete e.dataset.ship,e.classList.remove("hasShip"),e.classList.remove("head"))})),t.x=e.target.getAttribute("data-x"),t.y=e.target.getAttribute("data-y");for(let e=0;e<t.length;e++){if("x"===t.axis){let a=parseInt(t.x)+e,r=document.querySelector(`[data-x="${a}"][data-y="${t.y}"]`);0===e&&r.classList.add("head"),r.classList.add("hasShip"),r.dataset.ship=`${t.name}`}if("y"===t.axis){let a=parseInt(t.y)+e,r=document.querySelector(`[data-x="${t.x}"][data-y="${a}"]`);0===e&&r.classList.add("head"),r.classList.add("hasShip"),r.dataset.ship=`${t.name}`}}}})(e,A)};v.addEventListener("click",(()=>{if(k(m,M,"click"),k(m,C,"dblclick"),k(m,I,"mouseover"),$++,$==c.gameboard.fleet.length-1&&(v.textContent="Finish"),$==c.gameboard.fleet.length)return p.textContent="",p.classList.remove("instructions"),v.style.display="none",f.style.display="block",[...document.querySelectorAll(".cell")].forEach((e=>{e.classList.remove("head"),e.classList.add("gameOn")})),void(()=>{let e=!1,t=!1;const a=function(){let a=r(c),n=h.randomAttack(c);if(n.success){y.textContent="You've been hit!",w("computer",n.x,n.y,!0);let t=r(c);if(t.count>a.count){let e=t.list.filter((e=>!a.list.includes(e)))[0].toLowerCase();p.textContent=`They sunk your ${e}!`}if(c.gameboard.allSunk())return x.textContent="You lost!",b.classList.add("show"),void(e=!0)}else y.textContent="They missed!",w("computer",n.x,n.y,!1);t=!1},r=function(e){let t=0,a=[];return e.gameboard.fleet.forEach((e=>{e.isSunk()&&(a.push(e.name),t++)})),{count:t,list:a}};L(g,(function(n){if(e)return;if(n.target.matches(".hit")||n.target.matches(".miss"))return;if(t)return;t=!0,p.textContent="";let o=n.target.getAttribute("data-x"),l=n.target.getAttribute("data-y"),s=r(h),i=c.attack(h,o,l);if(i.success){y.textContent="You hit the enemy!",w("human",i.x,i.y,!0);let t=r(h);if(t.count>s.count){let e=t.list.filter((e=>!s.list.includes(e)))[0].toLowerCase();p.textContent=`You sunk a ${e}!`}if(h.gameboard.allSunk())return x.textContent="You won!",b.classList.add("show"),void(e=!0)}else y.textContent="You missed!",w("human",i.x,i.y,!1);setTimeout(a,2500)}))})();A=c.gameboard.fleet[$],v.disabled=!0,S(m,M,"click"),S(m,C,"dblclick"),S(m,I,"mouseover"),E=!1}));const q=()=>{f.style.display="none",p.innerHTML="Click on a cell to place a ship. Clicking on the head of the most recently placed ship allows you to move it again. <br/> &nbsp <br/> Double-clicking changes the ship's oriention. <br/> &nbsp <br/>When you finish placing ships, attack your opponent by clicking on their board.",p.classList.add("instructions"),L(m),S(m,M,"click"),S(m,C,"dblclick"),S(m,I,"mouseover")};document.getElementById("restart-button").addEventListener("click",(()=>{for(c.gameboard.occupiedSquares.length=0,c.gameboard.shotRecord.length=0,h.gameboard.occupiedSquares.length=0,h.gameboard.shotRecord.length=0,c.gameboard.fleet.forEach((e=>{e.x=null,e.y=null,e.setHits=0})),h.gameboard.fleet.forEach((e=>{e.x=null,e.y=null,e.setHits=0}));g.firstChild;)g.removeChild(g.lastChild);for(;m.firstChild;)m.removeChild(m.lastChild);h.randomlyPlaceShips(),b.classList.remove("show"),x.textContent="",y.textContent="",E=!1,$=0,A=c.gameboard.fleet[$],v.style.display="block",v.disabled=!0,v.textContent="Get next ship",q()})),q()})();
//# sourceMappingURL=bundlef5c17d858226f143b1eb.js.map